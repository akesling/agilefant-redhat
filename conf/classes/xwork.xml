<!DOCTYPE xwork PUBLIC "-//OpenSymphony Group//XWork 1.1.1//EN"
"http://www.opensymphony.com/xwork/xwork-1.1.1.dtd">

<xwork>
	<!-- Include webwork defaults (from WebWork JAR). -->
	<include file="webwork-default.xml" />

	<!-- Configuration for the default package. -->
	<package name="default" extends="webwork-default">
		<interceptors>
			<interceptor name="refreshUser"
				class="refreshUserInterceptor" />
			<interceptor name="contextView"
				class="contextViewInterceptor" />
			<interceptor-stack name="authenticationStack">
				<interceptor-ref name="completeStack" />
				<interceptor-ref name="refreshUser" />
				<interceptor-ref name="contextView" />
			</interceptor-stack>
		</interceptors>
		<default-interceptor-ref name="authenticationStack" />

		<global-results>
			<result name="input">/WEB-INF/jsp/genericError.jsp</result>
			<result name="error">/WEB-INF/jsp/genericError.jsp</result>
		</global-results>

		<action name="simpleCounter"
			class="fi.hut.soberit.agilefant.web.SimpleCounter">
			<result name="success">/WEB-INF/jsp/showCounter.jsp</result>
		</action>
		<action name="refreshChart" method="refreshChart"
			class="fi.hut.soberit.agilefant.web.SimpleCounter">
			<result name="success" type="stream">
				<param name="contentType">${contentType}</param>
				<param name="inputName">inputStream</param>
			</result>
		</action>
		<action name="resetCounter" method="resetCounter"
			class="fi.hut.soberit.agilefant.web.SimpleCounter">
			<result name="success">/WEB-INF/jsp/showCounter.jsp</result>
		</action>
		<!-- Context view -->
		<action name="contextView"
			class="fi.hut.soberit.agilefant.web.ContextViewAction">
			<result type="redirect-action">
				<param name="actionName">selectBacklog</param>
			</result>
			<result name="success_iteration" type="redirect-action">
				<param name="actionName">editIteration</param>
				<param name="iterationId">${contextObjectId}</param>
			</result>
			<result name="success_project" type="redirect-action">
				<param name="actionName">editDeliverable</param>
				<param name="deliverableId">${contextObjectId}</param>
			</result>
			<result name="success_product" type="redirect-action">
				<param name="actionName">editProduct</param>
				<param name="productId">${contextObjectId}</param>
			</result>
			<result name="success_portfolio" type="redirect-action">
				<param name="actionName">viewPortfolio</param>
			</result>
			<result name="success_myTasks" type="redirect-action">
				<param name="actionName">myTasks</param>
			</result>
			<result name="success_users" type="redirect-action">
				<param name="actionName">listUsers</param>
			</result>
			<result name="success_activityTypes" type="redirect-action">
				<param name="actionName">listActivityTypes</param>
			</result>
			<result name="success_createNew" type="redirect-action">
				<param name="actionName">createNew</param>
			</result>
			<result name="success_" type="redirect-action">
				<param name="actionName">selectBacklog</param>
			</result>
		</action>
		<!-- Activity type actions -->
		<action name="listActivityTypes" method="getAll"
			class="activityTypeAction">
			<result>/WEB-INF/jsp/listActivityTypes.jsp</result>
		</action>
		<action name="editActivityType" method="edit"
			class="activityTypeAction">
			<result>/WEB-INF/jsp/editActivityType.jsp</result>
		</action>
		<action name="createActivityType" method="create"
			class="activityTypeAction">
			<result>/WEB-INF/jsp/editActivityType.jsp</result>
		</action>
		<action name="deleteActivityType" method="delete"
			class="activityTypeAction">
			<result type="redirect-action">listActivityTypes</result>
		</action>
		<action name="storeActivityType" method="store"
			class="activityTypeAction">
			<result type="redirect-action">listActivityTypes</result>
		</action>
		<!-- /Activity type actions -->
		<!-- Work type actions -->
		<action name="editWorkType" method="edit"
			class="workTypeAction">
			<result>/WEB-INF/jsp/editWorkType.jsp</result>
		</action>
		<action name="createWorkType" method="create"
			class="workTypeAction">
			<result>/WEB-INF/jsp/editWorkType.jsp</result>
		</action>
		<action name="deleteWorkType" method="delete"
			class="workTypeAction">
			<result type="redirect-action">
				<param name="actionName">editActivityType</param>
				<param name="activityTypeId">${activityTypeId}</param>
			</result>
		</action>
		<action name="storeWorkType" method="store"
			class="workTypeAction">
			<result type="redirect-action">
				<param name="actionName">editActivityType</param>
				<param name="activityTypeId">${activityTypeId}</param>
			</result>
		</action>
		<!-- /Work type actions -->
		<!-- Product actions -->
		<action name="listProducts">
			<result>/WEB-INF/jsp/listProducts.jsp</result>
		</action>
		<action name="editProduct" method="edit"
			class="productAction">
			<result>/WEB-INF/jsp/editProduct.jsp</result>
		</action>
		<action name="createProduct" method="create"
			class="productAction">
			<result>/WEB-INF/jsp/editProduct.jsp</result>
		</action>
		<action name="deleteProduct" method="delete"
			class="productAction">
			<result>/WEB-INF/jsp/selectBacklog.jsp</result>
		</action>
		<action name="storeProduct" method="store"
			class="productAction">
			<result type="redirect-action">
				<param name="actionName">contextView</param>
				<param name="contextName">product</param>
				<param name="contextObjectId">${productId}</param>
				<param name="resetContextView">true</param>
			</result>
		</action>
		<action name="storeNewProduct" method="store"
			class="productAction">
			<result type="redirect-action">
				<param name="actionName">contextView</param>
				<param name="contextName">product</param>
				<param name="contextObjectId">${productId}</param>
				<param name="resetContextView">true</param>
			</result>
		</action>
		<!-- /Product actions -->
		<!-- BacklogItem actions -->
		<action name="listBacklogItems">
			<result>/WEB-INF/jsp/listBacklogItems.jsp</result>
		</action>
		<action name="editBacklogItem" method="edit"
			class="backlogItemAction">
			<result>/WEB-INF/jsp/editBacklogItem.jsp</result>
		</action>
		<action name="createBacklogItem" method="create"
			class="backlogItemAction">
			<result>/WEB-INF/jsp/editBacklogItem.jsp</result>
		</action>
		<action name="deleteBacklogItem" method="delete"
			class="backlogItemAction">
			<result type="redirect-action">
				<param name="actionName">popContext</param>
			</result>
		</action>
		<action name="storeBacklogItem" method="store"
			class="backlogItemAction">
			<result type="redirect">
				editBacklogItem.action?backlogItemId=${backlogItemId}
			</result>
		</action>
		<action name="storeNewBacklogItem" method="store"
			class="backlogItemAction">
			<result type="redirect">
				editBacklogItem.action?backlogItemId=${backlogItemId}
			</result>
		</action>
		<action name="linkToIterationGoal"
			class="linkToIterationGoalAction">
			<result type="redirect">
				editBacklogItem.action?backlogItemId=${backlogItemId}
			</result>
		</action>
		<!-- /BacklogItem actions -->

		<!-- Deliverable actions -->
		<action name="listDeliverables">
			<result>/WEB-INF/jsp/listDeliverables.jsp</result>
		</action>
		<action name="editDeliverable" method="edit"
			class="deliverableAction">
			<result>/WEB-INF/jsp/editDeliverable.jsp</result>
		</action>
		<action name="viewDeliverable" method="edit"
			class="deliverableAction">
			<result>/WEB-INF/jsp/viewDeliverable.jsp</result>
		</action>
		<action name="createDeliverable" method="create"
			class="deliverableAction">
			<result>/WEB-INF/jsp/editDeliverable.jsp</result>
		</action>
		<action name="deleteDeliverable" method="delete"
			class="deliverableAction">
			<result type="redirect">
				editProduct.action?productId=${productId}
			</result>
		</action>
		<action name="storeDeliverable" method="store"
			class="deliverableAction">
			<result type="redirect-action">
				<param name="actionName">contextView</param>
				<param name="contextName">project</param>
				<param name="contextObjectId">${deliverableId}</param>
				<param name="resetContextView">true</param>
			</result>
		</action>
		<action name="storeNewDeliverable" method="store"
			class="deliverableAction">
			<result type="redirect-action">
				<param name="actionName">contextView</param>
				<param name="contextName">project</param>
				<param name="contextObjectId">${deliverableId}</param>
				<param name="resetContextView">true</param>
			</result>
		</action>
		<!-- /Deliverable actions -->

		<!-- Work type actions -->
		<!-- TODO -->

		<!-- Backlog actions -->
		<action name="editBacklog" method="edit"
			class="backlogAction">
			<result name="editProduct" type="redirect">
				editProduct.action?productId=${backlogId}
			</result>
			<result name="editDeliverable" type="redirect">
				editDeliverable.action?deliverableId=${backlogId}
			</result>
			<result name="editIteration" type="redirect">
				editIteration.action?iterationId=${backlogId}
			</result>
		</action>

		<action name="moveSelectedItems" method="moveSelectedItems"
			class="backlogAction">
			<result name="editProduct" type="redirect">
				editProduct.action?productId=${backlogId}
			</result>
			<result name="editDeliverable" type="redirect">
				editDeliverable.action?deliverableId=${backlogId}
			</result>
			<result name="editIteration" type="redirect">
				editIteration.action?iterationId=${backlogId}
			</result>
		</action>

		<action name="moveBacklogItem" method="moveBacklogItem"
			class="backlogAction">
			<result name="editProduct" type="redirect">
				editProduct.action?productId=${backlogId}
			</result>
			<result name="editDeliverable" type="redirect">
				editDeliverable.action?deliverableId=${backlogId}
			</result>
			<result name="editIteration" type="redirect">
				editIteration.action?iterationId=${backlogId}
			</result>
		</action>
		<!-- /Backlog actions -->

		<!-- Task actions -->
		<action name="editTask" method="edit" class="taskAction">
			<result>/WEB-INF/jsp/editTask.jsp</result>
		</action>
		<action name="createTask" method="create" class="taskAction">
			<result>/WEB-INF/jsp/editTask.jsp</result>
		</action>
		<action name="deleteTask" method="delete" class="taskAction">
			<result type="redirect">
				editBacklogItem.action?backlogItemId=${backlogItemId}
			</result>
		</action>
		<action name="storeTask" method="store" class="taskAction">
			<result type="redirect-action">
				<param name="actionName">editTask</param>
				<param name="taskId">${taskId}</param>
				<param name="contextViewName">${contextViewName}</param>
				<param name="contextObjectId">${contextObjectId}</param>
			</result>
		</action>
		<action name="storeNewTask" method="store"
			class="taskAction">
			<result type="redirect-action">
				<param name="actionName">editTask</param>
				<param name="taskId">${taskId}</param>
				<param name="contextViewName">${contextViewName}</param>
				<param name="contextObjectId">${contextObjectId}</param>
			</result>
		</action>
		<!-- /Task actions -->

		<!-- Iteration actions -->
		<action name="editIteration" method="edit"
			class="iterationAction">
			<result>/WEB-INF/jsp/editIteration.jsp</result>
		</action>
		<action name="createIteration" method="create"
			class="iterationAction">
			<result>/WEB-INF/jsp/editIteration.jsp</result>
		</action>
		<action name="deleteIteration" method="delete"
			class="iterationAction">
			<result type="redirect">
				editDeliverable.action?deliverableId=${deliverableId}
			</result>
		</action>
		<action name="storeIteration" method="store"
			class="iterationAction">
			<result type="redirect-action">
				<param name="actionName">contextView</param>
				<param name="contextName">iteration</param>
				<param name="contextObjectId">${iterationId}</param>
				<param name="resetContextView">true</param>
			</result>			
		</action>
		<action name="storeNewIteration" method="store"
			class="iterationAction">
			<result type="redirect-action">
				<param name="actionName">contextView</param>
				<param name="contextName">iteration</param>
				<param name="contextObjectId">${iterationId}</param>
				<param name="resetContextView">true</param>
			</result>		
		</action>
		<action name="viewIteration" method="edit"
			class="iterationAction">
			<result>/WEB-INF/jsp/viewIteration.jsp</result>
		</action>
		<!-- /Iteration actions -->

		<!-- User actions -->
		<action name="assignTask" class="assignTaskAction">
			<result type="redirect">
				editTask.action?taskId=${taskId}
			</result>
		</action>
		<action name="listUsers">
			<result>/WEB-INF/jsp/listUsers.jsp</result>
		</action>
		<action name="editUser" method="edit" class="userAction">
			<result>/WEB-INF/jsp/editUser.jsp</result>
		</action>
		<action name="createUser" method="create" class="userAction">
			<result>/WEB-INF/jsp/editUser.jsp</result>
		</action>
		<action name="deleteUser" method="delete" class="userAction">
			<result type="redirect">listUsers.action</result>
		</action>
		<action name="storeUser" method="store" class="userAction">
			<result type="redirect">listUsers.action</result>
			<result name="error">/WEB-INF/jsp/editUser.jsp</result>
		</action>

		<!-- /User actions -->
		<!-- Perform work -->
		<action name="performWorkForm" method="edit"
			class="taskAction">
			<result>/WEB-INF/jsp/performWork.jsp</result>
		</action>
		<action name="performWork" class="performWorkAction">
			<result type="redirect">
				editTask.action?taskId=${task.id}
			</result>
		</action>
		<!-- /Perform work -->

		<!-- My tasks -->
		<action name="myTasks">
			<result>/WEB-INF/jsp/viewMyTasks.jsp</result>
		</action>
		<action name="editMyTasks">
			<result>/WEB-INF/jsp/editMyTasks.jsp</result>
		</action>
		<action name="myTasksReportForm" method="edit"
			class="taskAction">
			<result>/WEB-INF/jsp/viewMyTasks.jsp</result>
		</action>
		<action name="myTasksSwitchUser" method="edit"
			class="userAction">
			<result>/WEB-INF/jsp/viewMyTasks.jsp</result>
		</action>
		<action name="myTasksPerformWork" class="performWorkAction">
			<result type="redirect">editMyTasks.action</result>
		</action>
		<action name="myTasksBulkPerformWork"
			class="bulkPerformWorkAction">
			<result type="redirect">editMyTasks.action</result>
		</action>
		<!-- /My tasks -->

		<!-- IterationGoal actions -->
		<action name="editIterationGoal" method="edit"
			class="iterationGoalAction">
			<result>/WEB-INF/jsp/editIterationGoal.jsp</result>
		</action>
		<action name="createIterationGoal" method="create"
			class="iterationGoalAction">
			<result>/WEB-INF/jsp/editIterationGoal.jsp</result>
		</action>
		<action name="deleteIterationGoal" method="delete"
			class="iterationGoalAction">
			<result type="redirect">
				editIteration.action?iterationId=${iterationId}
			</result>
		</action>
		<action name="storeIterationGoal" method="store"
						class="iterationGoalAction">
			<result type="redirect-action">
				<param name="actionName">editIterationGoal</param>
				<param name="iterationGoalId">${iterationGoalId}</param>
				<param name="contextViewName">editIteration</param>
				<param name="contextObjectId">${iterationId}</param>
			</result>
		</action>
		<action name="storeNewIterationGoal" method="store"
			class="iterationGoalAction">
			<result type="redirect-action">
				<param name="actionName">editIterationGoal</param>
				<param name="iterationGoalId">${iterationGoalId}</param>
				<param name="contextViewName">editIteration</param>
				<param name="contextObjectId">${iterationId}</param>
			</result>
		</action>
		<action name="moveIterationGoal" 
						method="moveIterationGoal"
						class="iterationAction">
			<result type="redirect">
				editIterationGoal.action?iterationGoalId=${iterationGoalId}
			</result>
		</action>
		<!-- /IterationGoal actions -->

		<action name="viewPortfolio" class="portfolioAction">
			<result>/WEB-INF/jsp/viewPortfolio.jsp</result>
		</action>

		<action name="showWork" class="showPerformedWorkAction">
			<result>/WEB-INF/jsp/showPerformedWork.jsp</result>
		</action>
		<action name="drawChart" method="execute" class="chartAction">
			<result name="success" type="stream">
				<param name="contentType">${contentType}</param>
				<param name="inputName">inputStream</param>
			</result>
		</action>
		<action name="drawBarChart" method="barChart"
			class="chartAction">
			<result name="success" type="stream">
				<param name="contentType">${contentType}</param>
				<param name="inputName">inputStream</param>
			</result>
		</action>
		<action name="drawExtendedBarChart" method="extendedBarChart"
			class="chartAction">
			<result name="success" type="stream">
				<param name="contentType">${contentType}</param>
				<param name="inputName">inputStream</param>
			</result>
		</action>
		<action name="drawDemoChart" method="demoChart"
			class="chartAction">
			<result name="success" type="stream">
				<param name="contentType">${contentType}</param>
				<param name="inputName">inputStream</param>
			</result>
		</action>
		<action name="drawGantChart" method="ganttChart"
			class="chartAction">
			<result name="success" type="stream">
				<param name="contentType">${contentType}</param>
				<param name="inputName">inputStream</param>
			</result>
		</action>
		<action name="watchTask" class="watchObjectAction">
			<result type="redirect-action">
				<param name="actionName">editTask</param>
				<param name="taskId">${taskId}</param>
			</result>
		</action>
		<action name="watchBacklogItem" class="watchObjectAction">
			<result type="redirect-action">
				<param name="actionName">editBacklogItem</param>
				<param name="backlogItemId">${backlogItemId}</param>
			</result>
		</action>

		<action name="viewProject">
			<result>/WEB-INF/jsp/viewProject.jsp</result>
		</action>

		<action name="popContext" class="contextStackAction">
			<result type="redirect-action">
				<param name="actionName">selectBacklog</param>
			</result>
			<result name="success_viewIteration"
				type="redirect-action">
				<param name="actionName">viewIteration</param>
				<param name="iterationId">${view.contextObject}</param>
			</result>
			<result name="success_editIteration"
				type="redirect-action">
				<param name="actionName">editIteration</param>
				<param name="iterationId">${view.contextObject}</param>
			</result>

			<result name="success_viewDeliverable"
				type="redirect-action">
				<param name="actionName">viewDeliverable</param>
				<param name="deliverableId">
					${view.contextObject}
				</param>
			</result>
			<result name="success_editDeliverable"
				type="redirect-action">
				<param name="actionName">editDeliverable</param>
				<param name="deliverableId">
					${view.contextObject}
				</param>
			</result>

			<result name="success_editBacklogItem"
				type="redirect-action">
				<param name="actionName">editBacklogItem</param>
				<param name="backlogItemId">
					${view.contextObject}
				</param>
			</result>

			<result name="success_listProducts"
				type="redirect-action">
				<param name="actionName">listProducts</param>
			</result>
			<result name="success_editProduct" type="redirect-action">
				<param name="actionName">editProduct</param>
				<param name="productId">${view.contextObject}</param>
			</result>

			<result name="success_editIterationGoal"
				type="redirect-action">
				<param name="actionName">editIterationGoal</param>
				<param name="iterationGoalId">
					${view.contextObject}
				</param>
			</result>

			<result name="success_editMyTasks" type="redirect-action">
				<param name="actionName">editMyTasks</param>
			</result>
			<result name="success_myTasks" type="redirect-action">
				<param name="actionName">myTasks</param>
			</result>
		</action>
		
		<action name="selectBacklog">
			<result>/WEB-INF/jsp/selectBacklog.jsp</result>
		</action>
		
		<action name="createNew">
			<result>/WEB-INF/jsp/createNew.jsp</result>
		</action>
			
	</package>
</xwork>
